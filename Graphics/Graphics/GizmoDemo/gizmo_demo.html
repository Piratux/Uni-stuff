<html>

<head>
	<title>Example 01.03 - Materials and light</title>
	<script type="text/javascript" src="../libs/three.js"></script>
	<script type="text/javascript" src="../libs/jquery-1.9.0.js"></script>
	<script type="text/javascript" src="../libs/OrbitControls.js"></script>
	<script type="text/javascript" src="../libs/TransformControls2.js"></script>
	<script type="text/javascript" src="../libs/stats.js"></script>
	<script type="text/javascript" src="../libs/dat.gui.js"></script>
	<style>
		body{
			/* set margin to 0 and overflow to hidden, to go fullscreen */
			margin: 0;
			overflow: hidden;
		}
	</style>
</head>

<body>


<!-- Div which will hold the Output -->
<div id="WebGL-output"> </div>

<!-- Javascript code that runs our Three.js examples -->
<script type="text/javascript">

	// once everything is loaded, we run our Three.js stuff.
	$(function () {

		// create a scene, that will hold all our elements such as objects, cameras and lights.
		var scene = new THREE.Scene();

		// create a camera, which defines where we're looking at.
		var camera = new THREE.PerspectiveCamera(45, window.innerWidth / window.innerHeight, 0.1, 1000);

		// create a render and set the size
		var renderer = new THREE.WebGLRenderer();

		renderer.setClearColor(0xEEEEEE, 1.0);
		renderer.setSize(window.innerWidth, window.innerHeight);
		renderer.shadowMapEnabled = true;

		var width = 5;
		var height = 1;
		var depth = 5;
		
		var offset_x = -10;
		var offset_y = 0;
		var offset_z = -5;

		// create boxes
		for (var i = 0; i < 12; i++) { 
			var boxGeometry = new THREE.BoxGeometry(width, height, depth);
			var boxMaterial = new THREE.MeshLambertMaterial({color: 0xff0000});
			var box = new THREE.Mesh(boxGeometry, boxMaterial);
			box.castShadow = true;
			
			box.position.x = Math.min(7 * (width - 1), i * (width - 1));
			box.position.y = (0.5 + i * 1.2) * height;
			box.position.z = Math.max(0, (i - 7) * (depth - 1));
			
			box.position.x += offset_x;
			box.position.y += offset_y;
			box.position.z += offset_z;
			scene.add(box);
		}
	  
		// position and point the camera to the center of the scene
		camera.position.x = -30;
		camera.position.y = 40;
		camera.position.z = 30;
		camera.lookAt(scene.position);

		// add spotlight
		var spotLight = new THREE.SpotLight( 0xffffff );
		spotLight.position.set( -40, 60, -10 );
		scene.add( spotLight );

		// add the output of the renderer to the html element
		$("#WebGL-output").append(renderer.domElement);
		
		// controls for camera
		const orbit = new THREE.OrbitControls( camera, renderer.domElement );
		orbit.update();
		orbit.addEventListener("change", render);
		
		// controls for object moving/rotating/scaling
		const control = new THREE.TransformControls( camera, renderer.domElement, scene.children );
		control.addEventListener("change", render);
		
		// disable camera movement when controling object
		control.addEventListener("dragging-changed", function(event) { orbit.enabled = !event.value; });
		
		scene.add(control);
		
		// print control information
		control.printDefaultControls();
		
		render();
 
		function render() {
			// render
			renderer.render( scene, camera );
		}
		
		function add_box(scene, i) {
			// create box
			var width = 5;
			var height = 1;
			var depth = 5;
			
			var offset_x = -10;
			var offset_y = 0;
			var offset_z = -5;
		
			var boxGeometry = new THREE.BoxGeometry(width,height,depth);
			var boxMaterial = new THREE.MeshLambertMaterial({color: 0xff0000});
			var box = new THREE.Mesh(boxGeometry, boxMaterial);
			box.castShadow = true;
			
			box.position.x = Math.min(7 * (width - 1), i * (width - 1));
			box.position.y = (0.5 + i * 1.2) * height;
			box.position.z = Math.max(0, (i-7) * (depth - 1));
			
			box.position.x += offset_x;
			box.position.y += offset_y;
			box.position.z += offset_z;
			scene.add(box);
		}
	});



</script>
</body>
</html>
